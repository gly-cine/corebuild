<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‹±èªå­¦ç¿’ã‚µã‚¤ãƒˆ - ã‚¹ã‚¿ã‚¤ãƒªãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚©ãƒ³ãƒˆã¨ã—ã¦æ—¥æœ¬èªè¡¨ç¤ºã«é©ã—ãŸInterã‚’è¨­å®š */
        body { font-family: 'Inter', 'Noto Sans JP', sans-serif; }
        /* ç”»é¢å…¨ä½“ã«ãƒ•ã‚£ãƒƒãƒˆã—ã€ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’ç™ºç”Ÿã•ã›ãªã„ãŸã‚ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .h-screen-no-scroll { height: 100vh; overflow: hidden; }
        .word-button { transition: all 0.2s; }
        .word-button:hover { transform: translateY(-2px); box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1); }
        .selected { opacity: 0.5; pointer-events: none; }
        /* éŸ³å£°å…ˆè¡Œãƒ¢ãƒ¼ãƒ‰ç”¨ã®å¼·ã„ã¼ã‹ã— */
        .blur-strong { filter: blur(8px); }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // **ãƒ†ãƒ¼ãƒ 1: ã‚¹ã‚¿ã‚¤ãƒªãƒƒã‚·ãƒ¥ (Indigoã¨Emerald)**
                        'primary': '#4f46e5', // Indigo-600
                        'secondary': '#10b981', // Emerald-500
                        'danger': '#ef4444',
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-[#f9fafb] h-screen-no-scroll flex items-center justify-center p-4">

    <div id="app" class="w-full max-w-4xl bg-white shadow-2xl rounded-xl flex flex-col h-full md:h-5/6 overflow-hidden">

        <header id="app-header" class="p-6 bg-primary text-white rounded-t-xl shadow-lg flex flex-col md:flex-row justify-between items-center hidden">
            <h1 class="text-2xl font-bold tracking-tight">æµ·å¤–æ—…è¡Œã§ä¾¿åˆ©ãªãƒ•ãƒ¬ãƒ¼ã‚º</h1>
            
            <div class="flex items-center space-x-2 mt-3 md:mt-0">
                <label for="mode-selector" class="text-sm font-medium">å­¦ç¿’ãƒ¢ãƒ¼ãƒ‰:</label>
                <select id="mode-selector" onchange="changeMode(this.value)" class="text-gray-800 px-3 py-1 rounded-lg font-medium text-sm transition duration-200 focus:ring-primary focus:border-primary">
                    <option value="1">â‘  è‹±æ–‡å…ˆè¡Œ</option>
                    <option value="2">â‘¡ éŸ³å£°å…ˆè¡Œ</option>
                    <option value="3">â‘¢ ä¸¦ã¹æ›¿ãˆ</option>
                </select>
            </div>
        </header>

        <main class="flex-grow p-6 flex flex-col space-y-4 overflow-y-auto">

            <div id="selection-screen" class="p-12 flex flex-col items-center justify-center h-full text-center">
                <h2 id="selection-title" class="text-3xl font-extrabold text-gray-800 mb-8">å­¦ç¿’ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’é¸æŠã—ã¦ãã ã•ã„</h2>
                
                <div id="main-category-buttons" class="space-y-6 w-full max-w-md">
                    <button id="btn-travel" onclick="selectCategory('travel')" class="w-full py-4 bg-primary text-white text-xl font-bold rounded-xl shadow-lg hover:bg-indigo-700 transition-colors duration-200 transform hover:scale-[1.02]">
                        âœˆï¸ æ—…è¡Œç”¨è‹±èª
                    </button>
                    <button id="btn-common-test" onclick="showSubCategory('common_test')" class="w-full py-4 bg-primary text-white text-xl font-bold rounded-xl shadow-lg hover:bg-indigo-700 transition-colors duration-200 transform hover:scale-[1.02]">
                        ğŸ“š å…±é€šãƒ†ã‚¹ãƒˆå‡ºé¡Œæ–‡
                    </button>
                </div>
                
                <div id="common-test-sub-group" class="w-full max-w-md hidden">
                    <h2 id="common-test-sub-title" class="text-3xl font-extrabold text-gray-800 mb-4">å…±é€šãƒ†ã‚¹ãƒˆï¼šå­¦ç¿’å†…å®¹ã‚’é¸æŠ</h2>
                    <div id="common-test-sub" class="space-y-4">
                        <button onclick="startLearning('common_test_all')" class="w-full py-3 bg-secondary text-white font-bold rounded-lg hover:bg-emerald-600 transition-colors">
                            å…¨ã¦ (2006å¹´ã€œ2025å¹´)
                        </button>
                        <button onclick="startLearning('common_test_2025')" class="w-full py-3 bg-secondary text-white font-bold rounded-lg hover:bg-emerald-600 transition-colors">
                            2025å¹´åº¦å‡ºé¡Œæ–‡ã®ã¿
                        </button>
                    </div>
                </div>
                <div id="single-category-transition" class="mt-8 pt-6 w-full max-w-md hidden">...</div>
            </div>
            
            <div id="learning-screen" class="hidden flex-grow flex flex-col space-y-4">
                
                <div class="text-center text-sm text-gray-500 mb-4 flex justify-between items-center">
                    
                    <span id="progress-indicator" class="px-2 py-1 rounded-md text-gray-600 font-semibold"></span>

                    <div class="flex items-center space-x-2">
                        <label for="scene-filter" class="text-sm font-medium text-gray-600">çµã‚Šè¾¼ã¿:</label>
                        <select id="scene-filter" onchange="filterScenes(this.value)" class="text-gray-800 px-3 py-1 rounded-lg font-medium text-sm transition duration-200 focus:ring-primary focus:border-primary"></select>
                    </div>

                </div>
    
                <div id="english-display-card" class="bg-[#eef2ff] p-6 rounded-xl shadow-inner min-h-[100px] flex items-center justify-center transition-all duration-300">
                    <p id="english-text" class="text-xl md:text-2xl font-bold text-gray-800 text-center select-none">
                        å­¦ç¿’ãƒ¢ãƒ¼ãƒ‰ã‚’é¸æŠã—ã¦ãã ã•ã„
                    </p>
                </div>
    
                <div id="translation-card" class="bg-white p-4 border border-gray-200 rounded-xl shadow min-h-[60px] transition-all duration-300 hidden flex flex-col">
                    <p class="text-sm font-semibold text-gray-600 mb-1">å’Œè¨³</p>
                    <div class="flex-grow flex items-center justify-center">
                        <p id="japanese-text" class="text-lg text-gray-700 text-center w-full">
                            -
                        </p>
                    </div>
                </div>
    
                <div id="scramble-ui" class="space-y-4 hidden">
                    <div class="p-4 bg-indigo-100 rounded-xl border-dashed border-2 border-indigo-300 min-h-[80px]">
                        <p class="text-sm font-semibold text-indigo-700 mb-1">è§£ç­”æ§‹ç¯‰ã‚¨ãƒªã‚¢</p>
                        <div id="answer-area" class="flex flex-wrap gap-2">
                            </div>
                    </div>
    
                    <div class="p-4 bg-white rounded-xl shadow-md border-t border-gray-200">
                        <p class="text-sm font-semibold text-gray-600 mb-2">å˜èªã‚’é¸æŠã—ã¦æ­£ã—ã„è‹±æ–‡ã‚’å®Œæˆã•ã›ã‚ˆã†</p>
                        <div id="scrambled-words-area" class="flex flex-wrap gap-2">
                            </div>
                    </div>
    
                    <div class="flex justify-center space-x-4 pt-2">
                        <button id="check-answer-btn" onclick="checkScrambledAnswer()" class="px-6 py-2 bg-secondary text-white font-bold rounded-lg hover:bg-emerald-600 transition-colors shadow-md hidden">
                            è§£ç­”ãƒã‚§ãƒƒã‚¯
                        </button>
                        <button id="reset-scramble-btn" onclick="resetScramble()" class="px-6 py-2 bg-gray-500 text-white font-bold rounded-lg hover:bg-gray-600 transition-colors shadow-md hidden">
                            ãƒªã‚»ãƒƒãƒˆ
                        </button>
                    </div>
                </div>
    
                <div id="message-box" class="text-center py-2 text-lg font-semibold hidden rounded-lg"></div>
            </div>

        </main>

        <footer id="app-footer" class="p-6 bg-gray-100 rounded-b-xl border-t border-gray-200 flex justify-between items-center flex-wrap hidden">
            <div class="flex space-x-2">
                <button onclick="navigate(-1)" class="px-4 py-2 bg-gray-300 text-gray-800 rounded-lg hover:bg-gray-400 transition-colors font-medium">
                    &lt; å‰ã®æ–‡
                </button>
                <button onclick="navigate(1)" class="px-4 py-2 bg-gray-300 text-gray-800 rounded-lg hover:bg-gray-400 transition-colors font-medium">
                    æ¬¡ã®æ–‡ &gt;
                </button>
            </div>
            
            <button onclick="showSelectionScreen()" class="px-4 py-2 bg-gray-300 text-gray-800 rounded-lg hover:bg-gray-400 transition-colors font-medium">
                TOPç”»é¢
            </button>

            <div class="flex space-x-3 mt-4 md:mt-0">
                <button id="toggle-translation-btn" onclick="toggleTranslation()" class="px-6 py-2 bg-primary text-white font-bold rounded-lg hover:bg-indigo-700 transition-colors shadow-md hidden">
                    å’Œè¨³ã‚’è¡¨ç¤º
                </button>

                <button id="play-audio-btn" onclick="playAudio()" class="px-6 py-2 bg-red-500 text-white font-bold rounded-lg hover:bg-red-600 transition-colors shadow-md flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 108 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd" />
                    </svg>
                    éŸ³å£°å†ç”Ÿ
                </button>
            </div>
        </footer>

    </div>

<script>
    // --- ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã¨å®šæ•° ---
    let ALL_DB = []; // èª­ã¿è¾¼ã‚“ã å…¨ãƒ‡ãƒ¼ã‚¿
    let DB = []; // ç¾åœ¨ã®å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ (ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°å¾Œ)
    let currentMode = 1;
    let currentSentenceIndex = 0;
    let isTranslationVisible = false; // å’Œè¨³è¡¨ç¤ºã®çŠ¶æ…‹ã‚’ç¶­æŒ
    let correctWords = []; 
    let scrambledWords = []; 
    let answerSequence = []; 
    let currentCategoryKey = ''; 

    // JSONãƒ‘ã‚¹ã¨å¯¾å¿œã™ã‚‹éŸ³å£°ãƒ•ã‚©ãƒ«ãƒ€ã‚’å®šç¾©
    const CATEGORY_MAP = {
        'travel': { 
            jsonPath: './data/travel_sentences.json', 
            audioFolder: 'travel', 
            name: 'æ—…è¡Œç”¨è‹±èª'
        },
        'common_test_all': { 
            jsonPath: './data/sentences_converted.json', 
            audioFolder: 'common_test', 
            name: 'å…±é€šãƒ†ã‚¹ãƒˆå‡ºé¡Œæ–‡ï¼ˆå…¨æœŸé–“ï¼‰',
            filter: (item) => true 
        },
        'common_test_2025': { 
            jsonPath: './data/sentences_converted.json', 
            audioFolder: 'common_test', 
            name: 'å…±é€šãƒ†ã‚¹ãƒˆå‡ºé¡Œæ–‡ï¼ˆ2025å¹´åº¦ã®ã¿ï¼‰',
            filter: (item) => item.year === '2025å¹´åº¦å…±é€šãƒ†ã‚¹ãƒˆå‡ºé¡Œ'
        }
    };

    // --- DOMè¦ç´ ã®å‚ç…§ ---
    const modeSelectorEl = document.getElementById('mode-selector'); 
    const englishTextEl = document.getElementById('english-text');
    const japaneseTextEl = document.getElementById('japanese-text');
    const translationCardEl = document.getElementById('translation-card');
    const toggleTranslationBtn = document.getElementById('toggle-translation-btn');
    const scrambledWordsAreaEl = document.getElementById('scrambled-words-area');
    const answerAreaEl = document.getElementById('answer-area');
    const scrambleUiEl = document.getElementById('scramble-ui');
    const messageBoxEl = document.getElementById('message-box');
    const checkAnswerBtn = document.getElementById('check-answer-btn');
    const resetScrambleBtn = document.getElementById('reset-scramble-btn');
    const selectionScreenEl = document.getElementById('selection-screen'); 
    const learningScreenEl = document.getElementById('learning-screen'); 
    const commonTestSubGroupEl = document.getElementById('common-test-sub-group'); 
    const appHeaderEl = document.getElementById('app-header'); 
    const appFooterEl = document.getElementById('app-footer'); 
    const progressIndicatorEl = document.getElementById('progress-indicator'); 
    const selectionTitleEl = document.getElementById('selection-title');
    const mainCategoryButtonsEl = document.getElementById('main-category-buttons');
    const singleCategoryTransitionEl = document.getElementById('single-category-transition');
    const sceneFilterEl = document.getElementById('scene-filter'); 
    const commonTestSubEl = document.getElementById('common-test-sub');

    // --- ã‚¢ãƒ—ãƒªåˆæœŸåŒ– ---
    window.onload = function() {
        showSelectionScreen(); 
    };
    
    /**
     * ã‚«ãƒ†ã‚´ãƒªé¸æŠç”»é¢ã‚’è¡¨ç¤ºã—ã€å­¦ç¿’ç”»é¢ã‚’éè¡¨ç¤ºã«ã™ã‚‹
     */
    function showSelectionScreen() {
        selectionScreenEl.classList.remove('hidden');
        learningScreenEl.classList.add('hidden');
        appHeaderEl.classList.add('hidden');
        appFooterEl.classList.add('hidden');
        
        mainCategoryButtonsEl.classList.remove('hidden');
        commonTestSubGroupEl.classList.add('hidden'); 
        singleCategoryTransitionEl.classList.add('hidden');
        
        selectionTitleEl.textContent = 'å­¦ç¿’ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’é¸æŠã—ã¦ãã ã•ã„'; 
        selectionTitleEl.classList.remove('hidden'); 
        
        // é€²æ—è¡¨ç¤ºã‚’ãƒªã‚»ãƒƒãƒˆ
        progressIndicatorEl.textContent = ''; 
    }
    
    /**
     * å…±é€šãƒ†ã‚¹ãƒˆã®ã‚µãƒ–ã‚«ãƒ†ã‚´ãƒªé¸æŠç”»é¢ã‚’è¡¨ç¤º
     */
    function showSubCategory(key) {
        if (key === 'common_test') {
            mainCategoryButtonsEl.classList.add('hidden');
            commonTestSubGroupEl.classList.remove('hidden');
        }
    }


    /**
     * ã‚«ãƒ†ã‚´ãƒªãƒœã‚¿ãƒ³ãŒæŠ¼ã•ã‚ŒãŸã¨ãã®å‡¦ç† (ãƒ¡ã‚¤ãƒ³ã‚«ãƒ†ã‚´ãƒª)
     */
    function selectCategory(category) {
        if (category === 'travel') {
            startLearning('travel');
            return;
        } 
        // ä»–ã®ãƒ¡ã‚¤ãƒ³ã‚«ãƒ†ã‚´ãƒªãŒã‚ã‚Œã°ã“ã“ã«è¿½è¨˜
    }
    
    /**
     * å­¦ç¿’ã‚’é–‹å§‹ã—ã€DBã‚’ãƒ­ãƒ¼ãƒ‰ã™ã‚‹
     */
    async function startLearning(key) {
        const config = CATEGORY_MAP[key];
        if (!config) {
            showMessage('ã‚¨ãƒ©ãƒ¼: ä¸æ­£ãªã‚«ãƒ†ã‚´ãƒªãŒé¸æŠã•ã‚Œã¾ã—ãŸã€‚', 'danger');
            return;
        }
        
        // UIã®åˆ‡ã‚Šæ›¿ãˆ
        selectionScreenEl.classList.add('hidden');
        learningScreenEl.classList.remove('hidden');
        appHeaderEl.classList.remove('hidden');
        appFooterEl.classList.remove('hidden');
        document.getElementById('app-header').querySelector('h1').textContent = config.name;

        currentCategoryKey = key;
        
        try {
            englishTextEl.textContent = `ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ä¸­ã§ã™...`;
            
            let dataPromise;
            if (key === 'travel') {
                 // ãƒ¦ãƒ¼ã‚¶ãƒ¼æä¾›ã® travel_sentences.json ã‚’ä½¿ç”¨
                const provided_json_content = [
                  { "id": "travel_sentences_00001", "en": "I'd like to check in for my flight to New York.", "ja": "ãƒ‹ãƒ¥ãƒ¼ãƒ¨ãƒ¼ã‚¯è¡Œãã®ãƒ•ãƒ©ã‚¤ãƒˆã®ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³ã‚’ã—ãŸã„ã§ã™ã€‚", "year": null, "category_main": "ç©ºæ¸¯", "category_sub": "ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³", "priority": "é«˜" },
                  { "id": "travel_sentences_00002", "en": "Can I have a window seat, please?", "ja": "çª“å´ã®å¸­ã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚", "year": null, "category_main": "ç©ºæ¸¯", "category_sub": "ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³", "priority": "ä¸­" },
                  { "id": "travel_sentences_00003", "en": "How many bags can I check in?", "ja": "é ã‘è·ç‰©ã¯ä½•å€‹ã¾ã§ã§ã™ã‹ï¼Ÿ", "year": null, "category_main": "ç©ºæ¸¯", "category_sub": "ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³", "priority": "ä¸­" },
                  { "id": "travel_sentences_00004", "en": "Do I need to take my laptop out?", "ja": "ãƒãƒ¼ãƒˆãƒ‘ã‚½ã‚³ãƒ³ã‚’å–ã‚Šå‡ºã™å¿…è¦ãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "ç©ºæ¸¯", "category_sub": "ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯", "priority": "ä¸­" },
                  { "id": "travel_sentences_00005", "en": "Is this allowed in carry-on luggage?", "ja": "ã“ã‚Œã¯æ©Ÿå†…æŒã¡è¾¼ã¿ã§ãã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "ç©ºæ¸¯", "category_sub": "ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯", "priority": "ä¸­" },
                  { "id": "travel_sentences_00006", "en": "Which gate is the flight to Los Angeles?", "ja": "ãƒ­ã‚µãƒ³ã‚¼ãƒ«ã‚¹è¡Œãã®ãƒ•ãƒ©ã‚¤ãƒˆã¯ã©ã®ã‚²ãƒ¼ãƒˆã§ã™ã‹ï¼Ÿ", "year": null, "category_main": "ç©ºæ¸¯", "category_sub": "æ­ä¹—", "priority": "é«˜" },
                  { "id": "travel_sentences_00007", "en": "When does boarding start?", "ja": "æ­ä¹—ã¯ã„ã¤å§‹ã¾ã‚Šã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "ç©ºæ¸¯", "category_sub": "æ­ä¹—", "priority": "é«˜" },
                  { "id": "travel_sentences_00008", "en": "Where is the transfer desk?", "ja": "ä¹—ã‚Šç¶™ãã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã¯ã©ã“ã§ã™ã‹ï¼Ÿ", "year": null, "category_main": "ç©ºæ¸¯", "category_sub": "ä¹—ã‚Šç¶™ã", "priority": "ä½" },
                  { "id": "travel_sentences_00009", "en": "Iâ€™m here for sightseeing.", "ja": "è¦³å…‰ã§æ¥ã¾ã—ãŸã€‚", "year": null, "category_main": "ç©ºæ¸¯", "category_sub": "å‡ºå…¥å›½å¯©æŸ»", "priority": "é«˜" },
                  { "id": "travel_sentences_00010", "en": "My flight was delayed. What should I do?", "ja": "ãƒ•ãƒ©ã‚¤ãƒˆãŒé…ã‚ŒãŸã®ã§ã™ãŒã€ã©ã†ã™ã‚Œã°ã„ã„ã§ã™ã‹ï¼Ÿ", "year": null, "category_main": "ç©ºæ¸¯", "category_sub": "ãƒˆãƒ©ãƒ–ãƒ«", "priority": "ä¸­" },
                  { "id": "travel_sentences_00011", "en": "How do I get to the train station?", "ja": "é§…ã¸ã¯ã©ã†è¡Œã‘ã°ã„ã„ã§ã™ã‹ï¼Ÿ", "year": null, "category_main": "ç§»å‹•", "category_sub": "å¾’æ­©", "priority": "é«˜" },
                  { "id": "travel_sentences_00012", "en": "Could you take me to the airport, please?", "ja": "ç©ºæ¸¯ã¾ã§ãŠé¡˜ã„ã—ã¾ã™ã€‚", "year": null, "category_main": "ç§»å‹•", "category_sub": "ã‚¿ã‚¯ã‚·ãƒ¼", "priority": "é«˜" },
                  { "id": "travel_sentences_00013", "en": "How much is the fare to downtown?", "ja": "ä¸­å¿ƒè¡—ã¾ã§ã®é‹è³ƒã¯ã„ãã‚‰ã§ã™ã‹ï¼Ÿ", "year": null, "category_main": "ç§»å‹•", "category_sub": "ã‚¿ã‚¯ã‚·ãƒ¼", "priority": "é«˜" },
                  { "id": "travel_sentences_00014", "en": "Where can I buy a bus ticket?", "ja": "ãƒã‚¹ã®ãƒã‚±ãƒƒãƒˆã¯ã©ã“ã§è²·ãˆã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "ç§»å‹•", "category_sub": "ãƒã‚¹", "priority": "ä¸­" },
                  { "id": "travel_sentences_00015", "en": "Does this bus go to the city center?", "ja": "ã“ã®ãƒã‚¹ã¯å¸‚ã®ä¸­å¿ƒéƒ¨ã«è¡Œãã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "ç§»å‹•", "category_sub": "ãƒã‚¹", "priority": "é«˜" },
                  { "id": "travel_sentences_00016", "en": "Which platform does the train leave from?", "ja": "ãã®é›»è»Šã¯ã©ã®ãƒ›ãƒ¼ãƒ ã‹ã‚‰å‡ºã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "ç§»å‹•", "category_sub": "é›»è»Š", "priority": "ä¸­" },
                  { "id": "travel_sentences_00017", "en": "How long does it take to get there?", "ja": "ãã“ã¾ã§ã©ã®ãã‚‰ã„æ™‚é–“ãŒã‹ã‹ã‚Šã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "ç§»å‹•", "category_sub": "å…¨èˆ¬", "priority": "ä¸­" },
                  { "id": "travel_sentences_00018", "en": "Could you drop me off here, please?", "ja": "ã“ã“ã§é™ã‚ã—ã¦ã‚‚ã‚‰ãˆã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "ç§»å‹•", "category_sub": "ã‚¿ã‚¯ã‚·ãƒ¼", "priority": "ä¸­" },
                  { "id": "travel_sentences_00019", "en": "Is it within walking distance?", "ja": "æ­©ã„ã¦è¡Œã‘ã‚‹è·é›¢ã§ã™ã‹ï¼Ÿ", "year": null, "category_main": "ç§»å‹•", "category_sub": "å¾’æ­©", "priority": "ä½" },
                  { "id": "travel_sentences_00020", "en": "I think Iâ€™m lost. Can you help me?", "ja": "é“ã«è¿·ã„ã¾ã—ãŸã€‚åŠ©ã‘ã¦ã‚‚ã‚‰ãˆã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "ç§»å‹•", "category_sub": "å¾’æ­©", "priority": "é«˜" },
                  { "id": "travel_sentences_00021", "en": "I have a reservation under the name of Tanaka.", "ja": "ç”°ä¸­ã®åå‰ã§äºˆç´„ã—ã¦ã„ã¾ã™ã€‚", "year": null, "category_main": "ãƒ›ãƒ†ãƒ«", "category_sub": "ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³", "priority": "é«˜" },
                  { "id": "travel_sentences_00022", "en": "Could I have your ID and credit card, please?", "ja": "èº«åˆ†è¨¼æ˜æ›¸ã¨ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚ï¼ˆâ€»ãƒ›ãƒ†ãƒ«å´ã®è³ªå•ä¾‹ï¼‰", "year": null, "category_main": "ãƒ›ãƒ†ãƒ«", "category_sub": "ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³", "priority": "ä¸­" },
                  { "id": "travel_sentences_00023", "en": "What time is check-out?", "ja": "ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆã¯ä½•æ™‚ã§ã™ã‹ï¼Ÿ", "year": null, "category_main": "ãƒ›ãƒ†ãƒ«", "category_sub": "ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³", "priority": "é«˜" },
                  { "id": "travel_sentences_00024", "en": "Could I have a late check-out, please?", "ja": "ãƒ¬ã‚¤ãƒˆãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆã‚’ãŠé¡˜ã„ã§ãã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "ãƒ›ãƒ†ãƒ«", "category_sub": "ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆ", "priority": "ä¸­" },
                  { "id": "travel_sentences_00025", "en": "Is breakfast included?", "ja": "æœé£Ÿã¯å«ã¾ã‚Œã¦ã„ã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "ãƒ›ãƒ†ãƒ«", "category_sub": "ã‚µãƒ¼ãƒ“ã‚¹", "priority": "é«˜" },
                  { "id": "travel_sentences_00026", "en": "Could you bring some extra towels, please?", "ja": "ã‚¿ã‚ªãƒ«ã‚’ã‚‚ã†å°‘ã—æŒã£ã¦ãã¦ã‚‚ã‚‰ãˆã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "ãƒ›ãƒ†ãƒ«", "category_sub": "ã‚µãƒ¼ãƒ“ã‚¹", "priority": "ä¸­" },
                  { "id": "travel_sentences_00027", "en": "The air conditioner isnâ€™t working.", "ja": "ã‚¨ã‚¢ã‚³ãƒ³ãŒå‹•ãã¾ã›ã‚“ã€‚", "year": null, "category_main": "ãƒ›ãƒ†ãƒ«", "category_sub": "ãƒˆãƒ©ãƒ–ãƒ«", "priority": "ä¸­" },
                  { "id": "travel_sentences_00028", "en": "Where is the nearest convenience store?", "ja": "ä¸€ç•ªè¿‘ã„ã‚³ãƒ³ãƒ“ãƒ‹ã¯ã©ã“ã§ã™ã‹ï¼Ÿ", "year": null, "category_main": "ãƒ›ãƒ†ãƒ«", "category_sub": "å‘¨è¾ºæƒ…å ±", "priority": "ä½" },
                  { "id": "travel_sentences_00029", "en": "Iâ€™d like to leave my luggage here until this afternoon.", "ja": "åˆå¾Œã¾ã§è·ç‰©ã‚’é ã‹ã£ã¦ã‚‚ã‚‰ãˆã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "ãƒ›ãƒ†ãƒ«", "category_sub": "ã‚µãƒ¼ãƒ“ã‚¹", "priority": "é«˜" },
                  { "id": "travel_sentences_00030", "en": "Could you call a taxi for me, please?", "ja": "ã‚¿ã‚¯ã‚·ãƒ¼ã‚’å‘¼ã‚“ã§ã‚‚ã‚‰ãˆã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "ãƒ›ãƒ†ãƒ«", "category_sub": "ã‚µãƒ¼ãƒ“ã‚¹", "priority": "é«˜" },
                  { "id": "travel_sentences_00031", "en": "Could you take a picture of me, please?", "ja": "å†™çœŸã‚’æ’®ã£ã¦ã‚‚ã‚‰ãˆã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "è¦³å…‰", "category_sub": "è¦³å…‰åœ°", "priority": "é«˜" },
                  { "id": "travel_sentences_00032", "en": "What time does the museum open?", "ja": "åšç‰©é¤¨ã¯ä½•æ™‚ã«é–‹ãã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "è¦³å…‰", "category_sub": "æ–½è¨­", "priority": "é«˜" },
                  { "id": "travel_sentences_00033", "en": "How much is the entrance fee?", "ja": "å…¥å ´æ–™ã¯ã„ãã‚‰ã§ã™ã‹ï¼Ÿ", "year": null, "category_main": "è¦³å…‰", "category_sub": "æ–½è¨­", "priority": "é«˜" },
                  { "id": "travel_sentences_00034", "en": "Is there a guided tour available?", "ja": "ã‚¬ã‚¤ãƒ‰ãƒ„ã‚¢ãƒ¼ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "è¦³å…‰", "category_sub": "è¦³å…‰ãƒ„ã‚¢ãƒ¼", "priority": "ä¸­" },
                  { "id": "travel_sentences_00035", "en": "Where can I buy tickets for the boat cruise?", "ja": "ãƒœãƒ¼ãƒˆã‚¯ãƒ«ãƒ¼ã‚ºã®ãƒã‚±ãƒƒãƒˆã¯ã©ã“ã§è²·ãˆã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "è¦³å…‰", "category_sub": "ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£", "priority": "ä¸­" },
                  { "id": "travel_sentences_00036", "en": "How long does the tour take?", "ja": "ãƒ„ã‚¢ãƒ¼ã¯ã©ã®ãã‚‰ã„æ™‚é–“ãŒã‹ã‹ã‚Šã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "è¦³å…‰", "category_sub": "è¦³å…‰ãƒ„ã‚¢ãƒ¼", "priority": "ä¸­" },
                  { "id": "travel_sentences_00037", "en": "Are there any famous restaurants around here?", "ja": "ã“ã®è¿‘ãã«æœ‰åãªãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "è¦³å…‰", "category_sub": "å‘¨è¾ºæƒ…å ±", "priority": "ä¸­" },
                  { "id": "travel_sentences_00038", "en": "Can I get there on foot?", "ja": "ãã“ã¸ã¯æ­©ã„ã¦è¡Œã‘ã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "è¦³å…‰", "category_sub": "é“æ¡ˆå†…", "priority": "ä½" },
                  { "id": "travel_sentences_00039", "en": "Where is the nearest restroom?", "ja": "ä¸€ç•ªè¿‘ã„ãƒˆã‚¤ãƒ¬ã¯ã©ã“ã§ã™ã‹ï¼Ÿ", "year": null, "category_main": "è¦³å…‰", "category_sub": "å‘¨è¾ºæƒ…å ±", "priority": "é«˜" },
                  { "id": "travel_sentences_00040", "en": "Whatâ€™s the best way to get to the city center?", "ja": "å¸‚ã®ä¸­å¿ƒéƒ¨ã¸è¡Œãä¸€ç•ªè‰¯ã„æ–¹æ³•ã¯ä½•ã§ã™ã‹ï¼Ÿ", "year": null, "category_main": "è¦³å…‰", "category_sub": "é“æ¡ˆå†…", "priority": "é«˜" },
                  { "id": "travel_sentences_00041", "en": "Table for two, please.", "ja": "2äººç”¨ã®å¸­ã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚", "year": null, "category_main": "é£Ÿäº‹", "category_sub": "å…¥åº—ãƒ»æ¡ˆå†…", "priority": "é«˜" },
                  { "id": "travel_sentences_00042", "en": "Could we see the menu, please?", "ja": "ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’è¦‹ã›ã¦ã‚‚ã‚‰ãˆã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "é£Ÿäº‹", "category_sub": "æ³¨æ–‡å‰", "priority": "é«˜" },
                  { "id": "travel_sentences_00043", "en": "What do you recommend?", "ja": "ãŠã™ã™ã‚ã¯ä½•ã§ã™ã‹ï¼Ÿ", "year": null, "category_main": "é£Ÿäº‹", "category_sub": "æ³¨æ–‡å‰", "priority": "ä¸­" },
                  { "id": "travel_sentences_00044", "en": "Iâ€™ll have this one, please.", "ja": "ã“ã‚Œã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚", "year": null, "category_main": "é£Ÿäº‹", "category_sub": "æ³¨æ–‡", "priority": "é«˜" },
                  { "id": "travel_sentences_00045", "en": "Could I get some water, please?", "ja": "ãŠæ°´ã‚’ã„ãŸã ã‘ã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "é£Ÿäº‹", "category_sub": "æ³¨æ–‡", "priority": "é«˜" },
                  { "id": "travel_sentences_00046", "en": "Does this dish contain nuts or seafood?", "ja": "ã“ã®æ–™ç†ã«ã¯ãƒŠãƒƒãƒ„ã‚„ã‚·ãƒ¼ãƒ•ãƒ¼ãƒ‰ãŒå…¥ã£ã¦ã„ã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "é£Ÿäº‹", "category_sub": "æ³¨æ–‡å‰", "priority": "ä¸­" },
                  { "id": "travel_sentences_00047", "en": "Could we have the bill, please?", "ja": "ãŠä¼šè¨ˆã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚", "year": null, "category_main": "é£Ÿäº‹", "category_sub": "ä¼šè¨ˆ", "priority": "é«˜" },
                  { "id": "travel_sentences_00048", "en": "Is service charge included?", "ja": "ã‚µãƒ¼ãƒ“ã‚¹æ–™ã¯å«ã¾ã‚Œã¦ã„ã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "é£Ÿäº‹", "category_sub": "ä¼šè¨ˆ", "priority": "ä¸­" },
                  { "id": "travel_sentences_00049", "en": "Could you pack this to go?", "ja": "ã“ã‚Œã‚’æŒã¡å¸°ã‚Šã«ã—ã¦ã‚‚ã‚‰ãˆã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "é£Ÿäº‹", "category_sub": "æŒã¡å¸°ã‚Š", "priority": "ä¸­" },
                  { "id": "travel_sentences_00050", "en": "Everything was delicious, thank you!", "ja": "ã™ã¹ã¦ã¨ã¦ã‚‚ç¾å‘³ã—ã‹ã£ãŸã§ã™ã€ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸï¼", "year": null, "category_main": "é£Ÿäº‹", "category_sub": "ãã®ä»–", "priority": "ä½" },
                  { "id": "travel_sentences_00051", "en": "How much is this?", "ja": "ã“ã‚Œã¯ã„ãã‚‰ã§ã™ã‹ï¼Ÿ", "year": null, "category_main": "è²·ã„ç‰©", "category_sub": "ä¾¡æ ¼", "priority": "é«˜" },
                  { "id": "travel_sentences_00052", "en": "Can I try this on?", "ja": "è©¦ç€ã—ã¦ã‚‚ã„ã„ã§ã™ã‹ï¼Ÿ", "year": null, "category_main": "è²·ã„ç‰©", "category_sub": "è¡£æ–™å“", "priority": "é«˜" },
                  { "id": "travel_sentences_00053", "en": "Do you have this in a different size?", "ja": "ã“ã‚Œã®åˆ¥ã®ã‚µã‚¤ã‚ºã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "è²·ã„ç‰©", "category_sub": "è¡£æ–™å“", "priority": "ä¸­" },
                  { "id": "travel_sentences_00054", "en": "Do you have this in another color?", "ja": "ã“ã‚Œã®åˆ¥ã®è‰²ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "è²·ã„ç‰©", "category_sub": "è¡£æ–™å“", "priority": "ä¸­" },
                  { "id": "travel_sentences_00055", "en": "Could you give me a discount?", "ja": "å€¤å¼•ãã—ã¦ã‚‚ã‚‰ãˆã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "è²·ã„ç‰©", "category_sub": "ä¾¡æ ¼", "priority": "ä¸­" },
                  { "id": "travel_sentences_00056", "en": "Iâ€™m just looking, thank you.", "ja": "è¦‹ã¦ã„ã‚‹ã ã‘ã§ã™ã€ã‚ã‚ŠãŒã¨ã†ã€‚", "year": null, "category_main": "è²·ã„ç‰©", "category_sub": "åº—å“¡", "priority": "é«˜" },
                  { "id": "travel_sentences_00057", "en": "Could I pay by credit card?", "ja": "ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ã§æ”¯æ‰•ãˆã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "è²·ã„ç‰©", "category_sub": "æ”¯æ‰•ã„", "priority": "é«˜" },
                  { "id": "travel_sentences_00058", "en": "Can I get a receipt, please?", "ja": "ãƒ¬ã‚·ãƒ¼ãƒˆã‚’ã‚‚ã‚‰ãˆã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "è²·ã„ç‰©", "category_sub": "æ”¯æ‰•ã„", "priority": "ä¸­" },
                  { "id": "travel_sentences_00059", "en": "Is tax included in the price?", "ja": "ã“ã®å€¤æ®µã«ç¨é‡‘ã¯å«ã¾ã‚Œã¦ã„ã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "è²·ã„ç‰©", "category_sub": "æ”¯æ‰•ã„", "priority": "ä¸­" },
                  { "id": "travel_sentences_00060", "en": "Could you wrap this as a gift, please?", "ja": "ã‚®ãƒ•ãƒˆç”¨ã«åŒ…ã‚“ã§ã‚‚ã‚‰ãˆã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "è²·ã„ç‰©", "category_sub": "ã‚µãƒ¼ãƒ“ã‚¹", "priority": "ä½" },
                  { "id": "travel_sentences_00061", "en": "Call the police, please!", "ja": "è­¦å¯Ÿã‚’å‘¼ã‚“ã§ãã ã•ã„ï¼", "year": null, "category_main": "ç·Šæ€¥", "category_sub": "ãƒˆãƒ©ãƒ–ãƒ«", "priority": "é«˜" },
                  { "id": "travel_sentences_00062", "en": "I need an ambulance!", "ja": "æ•‘æ€¥è»Šã‚’å‘¼ã‚“ã§ãã ã•ã„ï¼", "year": null, "category_main": "ç·Šæ€¥", "category_sub": "ç—…æ°—", "priority": "é«˜" },
                  { "id": "travel_sentences_00063", "en": "My wallet has been stolen.", "ja": "è²¡å¸ƒã‚’ç›—ã¾ã‚Œã¾ã—ãŸã€‚", "year": null, "category_main": "ç·Šæ€¥", "category_sub": "ãƒˆãƒ©ãƒ–ãƒ«", "priority": "é«˜" },
                  { "id": "travel_sentences_00064", "en": "Iâ€™ve lost my passport.", "ja": "ãƒ‘ã‚¹ãƒãƒ¼ãƒˆã‚’ãªãã—ã¾ã—ãŸã€‚", "year": null, "category_main": "ç·Šæ€¥", "category_sub": "ãƒˆãƒ©ãƒ–ãƒ«", "priority": "é«˜" },
                  { "id": "travel_sentences_00065", "en": "I donâ€™t feel well.", "ja": "æ°—åˆ†ãŒæ‚ªã„ã§ã™ã€‚", "year": null, "category_main": "ç·Šæ€¥", "category_sub": "ç—…æ°—", "priority": "é«˜" },
                  { "id": "travel_sentences_00066", "en": "Where is the nearest hospital?", "ja": "ä¸€ç•ªè¿‘ã„ç—…é™¢ã¯ã©ã“ã§ã™ã‹ï¼Ÿ", "year": null, "category_main": "ç·Šæ€¥", "category_sub": "ç—…æ°—", "priority": "é«˜" },
                  { "id": "travel_sentences_00067", "en": "I need to see a doctor.", "ja": "åŒ»è€…ã«è¨ºã¦ã‚‚ã‚‰ã„ãŸã„ã§ã™ã€‚", "year": null, "category_main": "ç·Šæ€¥", "category_sub": "ç—…æ°—", "priority": "ä¸­" },
                  { "id": "travel_sentences_00068", "en": "Can you help me contact the embassy?", "ja": "å¤§ä½¿é¤¨ã«é€£çµ¡ã™ã‚‹ã®ã‚’æ‰‹ä¼ã£ã¦ã‚‚ã‚‰ãˆã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "ç·Šæ€¥", "category_sub": "ãƒˆãƒ©ãƒ–ãƒ«", "priority": "ä¸­" },
                  { "id": "travel_sentences_00069", "en": "Someone is following me.", "ja": "èª°ã‹ã«å¾Œã‚’ã¤ã‘ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚", "year": null, "category_main": "ç·Šæ€¥", "category_sub": "ãƒˆãƒ©ãƒ–ãƒ«", "priority": "ä¸­" },
                  { "id": "travel_sentences_00070", "en": "I need to report a theft.", "ja": "ç›—é›£ã‚’å±Šã‘å‡ºãŸã„ã§ã™ã€‚", "year": null, "category_main": "ç·Šæ€¥", "category_sub": "ãƒˆãƒ©ãƒ–ãƒ«", "priority": "ä¸­" },
                  { "id": "travel_sentences_00071", "en": "Excuse me.", "ja": "ã™ã¿ã¾ã›ã‚“ã€‚ï¼ã¡ã‚‡ã£ã¨ã„ã„ã§ã™ã‹ã€‚", "year": null, "category_main": "æ±ç”¨", "category_sub": "ä¼šè©±", "priority": "é«˜" },
                  { "id": "travel_sentences_00072", "en": "Could you help me, please?", "ja": "æ‰‹ä¼ã£ã¦ã‚‚ã‚‰ãˆã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "æ±ç”¨", "category_sub": "ä¾é ¼", "priority": "é«˜" },
                  { "id": "travel_sentences_00073", "en": "I donâ€™t understand.", "ja": "ã‚ã‹ã‚Šã¾ã›ã‚“ã€‚", "year": null, "category_main": "æ±ç”¨", "category_sub": "ä¼šè©±", "priority": "é«˜" },
                  { "id": "travel_sentences_00074", "en": "Could you say that again, please?", "ja": "ã‚‚ã†ä¸€åº¦è¨€ã£ã¦ã‚‚ã‚‰ãˆã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "æ±ç”¨", "category_sub": "ä¼šè©±", "priority": "é«˜" },
                  { "id": "travel_sentences_00075", "en": "Do you speak English?", "ja": "è‹±èªã‚’è©±ã›ã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "æ±ç”¨", "category_sub": "ä¼šè©±", "priority": "é«˜" },
                  { "id": "travel_sentences_00076", "en": "Could you write it down, please?", "ja": "æ›¸ã„ã¦ã‚‚ã‚‰ãˆã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "æ±ç”¨", "category_sub": "ä¾é ¼", "priority": "ä¸­" },
                  { "id": "travel_sentences_00077", "en": "Thatâ€™s okay, thank you.", "ja": "å¤§ä¸ˆå¤«ã§ã™ã€ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚", "year": null, "category_main": "æ±ç”¨", "category_sub": "ä¼šè©±", "priority": "ä¸­" },
                  { "id": "travel_sentences_00078", "en": "Where can I find this?", "ja": "ã“ã‚Œã¯ã©ã“ã«ã‚ã‚Šã¾ã™ã‹ï¼Ÿ", "year": null, "category_main": "æ±ç”¨", "category_sub": "é“æ¡ˆå†…", "priority": "ä¸­" },
                  { "id": "travel_sentences_00079", "en": "Iâ€™m sorry, Iâ€™m not from around here.", "ja": "ã™ã¿ã¾ã›ã‚“ã€ç§ã¯ã“ã®è¾ºã®è€…ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚", "year": null, "category_main": "æ±ç”¨", "category_sub": "ä¼šè©±", "priority": "ä½" },
                  { "id": "travel_sentences_00080", "en": "Thank you so much!", "ja": "æœ¬å½“ã«ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼", "year": null, "category_main": "æ±ç”¨", "category_sub": "ä¼šè©±", "priority": "é«˜" }
                ];
                dataPromise = Promise.resolve(provided_json_content);
            } else if (key === 'common_test_all' || key === 'common_test_2025') {
                 // ãƒ¦ãƒ¼ã‚¶ãƒ¼æä¾›ã® sentences_converted.json ã‚’ä½¿ç”¨
                 const provided_json_content = [
                    { "id": "sentence0003", "en": "So, I asked Kenji if he could do it instead of me", "ja": "ãã“ã§ã€ç§ã®ä»£ã‚ã‚Šã«ãã‚Œã‚’ã‚„ã£ã¦ãã‚Œã‚‹ã‹ã‚±ãƒ³ã‚¸ã«å°‹ã­ã¾ã—ãŸ", "year": "2006å¹´åº¦ã‚»ãƒ³ã‚¿ãƒ¼è©¦é¨“å‡ºé¡Œ" },
                    { "id": "sentence0004", "en": "I want to go to the National Museum", "ja": "å›½ç«‹åšç‰©é¤¨ã¸è¡ŒããŸã„ã§ã™", "year": "2006å¹´åº¦ã‚»ãƒ³ã‚¿ãƒ¼è©¦é¨“å‡ºé¡Œ" },
                    { "id": "sentence0008", "en": "I found a nice hotel in Paris that I liked very much", "ja": "ãƒ‘ãƒªã§ç´ æ•µãªãƒ›ãƒ†ãƒ«ã‚’è¦‹ã¤ã‘ã¦ã€ã¨ã¦ã‚‚æ°—ã«å…¥ã‚Šã¾ã—ãŸ", "year": "2006å¹´åº¦ã‚»ãƒ³ã‚¿ãƒ¼è©¦é¨“å‡ºé¡Œ" },
                    { "id": "sentence0009", "en": "Yeah, Saturday looks bad â€• cloudy and rainy.", "ja": "ã‚ãã€åœŸæ›œæ—¥ã¯æ‚ªãã†ã ã€‚æ›‡ã‚Šæ™‚ã€…é›¨ã ã‚ˆã€‚", "year": "2006å¹´åº¦ã‚»ãƒ³ã‚¿ãƒ¼è©¦é¨“å‡ºé¡Œ" },
                    { "id": "sentence0010", "en": "Could you have him call me back after four o'clock?", "ja": "å››æ™‚ä»¥é™ã«é›»è©±ã‚’ã‹ã‘ç›´ã™ã‚ˆã†å½¼ã«è¨€ã£ã¦ãã‚Œã¾ã™ã‹ï¼Ÿ", "year": "2007å¹´åº¦ã‚»ãƒ³ã‚¿ãƒ¼è©¦é¨“å‡ºé¡Œ" },
                    { "id": "sentence0399", "en": "In a survey of Americans, 76 percent said they thought regifting was all right, but in reality, many are reluctant to regift.", "ja": "ã‚¢ãƒ¡ãƒªã‚«äººã¸ã®èª¿æŸ»ã§ã¯ã€76ï¼…ãŒã€Œãƒªã‚®ãƒ•ãƒ†ã‚£ãƒ³ã‚°ï¼ˆä»–äººã‹ã‚‰ã®ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆã‚’åˆ¥ã®äººã«ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆã™ã‚‹ã“ã¨ï¼‰ã¯å•é¡Œãªã„ã€ã¨ç­”ãˆã¾ã—ãŸãŒã€å®Ÿéš›ã«ã¯å¤šãã®äººãŒãã‚Œã‚’ã™ã‚‹ã“ã¨ã‚’ãŸã‚ã‚‰ã£ã¦ã„ã¾ã™ã€‚", "year": "2025å¹´åº¦å…±é€šãƒ†ã‚¹ãƒˆå‡ºé¡Œ" },
                    { "id": "sentence0400", "en": "It's interesting that many Americans think regifting is OK, but still hesitate to do it.", "ja": "å¤šãã®ã‚¢ãƒ¡ãƒªã‚«äººãŒã€Œãƒªã‚®ãƒ•ãƒ†ã‚£ãƒ³ã‚°ï¼ˆä»–äººã‹ã‚‰ã®ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆã‚’åˆ¥ã®äººã«ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆã™ã‚‹ã“ã¨ï¼‰ã€ã¯å•é¡Œãªã„ã¨æ€ã£ã¦ã„ã‚‹ã®ã«ã€ãã‚Œã§ã‚‚ãã‚Œã‚’ãŸã‚ã‚‰ã†ã®ã¯èˆˆå‘³æ·±ã„ã€‚", "year": "2025å¹´åº¦å…±é€šãƒ†ã‚¹ãƒˆå‡ºé¡Œ" },
                    { "id": "sentence0405", "en": "The waves are usually less than 1 meter high, so there are always lots of surfers in the water.", "ja": "æ³¢ã®é«˜ã•ã¯é€šå¸¸1ãƒ¡ãƒ¼ãƒˆãƒ«æœªæº€ãªã®ã§ã€æµ·ã«ã¯ã„ã¤ã‚‚å¤šãã®ã‚µãƒ¼ãƒ•ã‚¡ãƒ¼ãŒã„ã¾ã™ã€‚", "year": "2025å¹´åº¦å…±é€šãƒ†ã‚¹ãƒˆå‡ºé¡Œ" },
                    { "id": "sentence0406", "en": "I'll chew more, eat less, and then I'll feel healthier.", "ja": "ã‚‚ã£ã¨å™›ã‚“ã§ã€é£Ÿã¹ã‚‹é‡ã‚’æ¸›ã‚‰ã›ã°ã€ã‚‚ã£ã¨å¥åº·çš„ã«æ„Ÿã˜ã‚‰ã‚Œã‚‹ã¯ãšã€‚", "year": "2025å¹´åº¦å…±é€šãƒ†ã‚¹ãƒˆå‡ºé¡Œ" }
                ];

                let filtered_content = provided_json_content;
                if (config.filter) {
                    filtered_content = provided_json_content.filter(config.filter);
                }
                dataPromise = Promise.resolve(filtered_content);
            }
            
            ALL_DB = await dataPromise; 

            if (ALL_DB.length === 0) {
                englishTextEl.textContent = `${config.name} ã®ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚`;
                showMessage('JSONãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚', 'danger');
                return;
            }
            
            // å ´é¢ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’åˆæœŸåŒ–
            setupSceneFilter(ALL_DB); 
            
            // ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã‚’é©ç”¨ã—ã€æœ€åˆã®æ–‡ã‚’ãƒ­ãƒ¼ãƒ‰
            filterScenes('ALL'); // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯å…¨ã¦ã®å ´é¢
            
        } catch (error) {
            console.error("ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:", error);
            englishTextEl.textContent = `ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚\n${error.message}`;
            showMessage('ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãƒ­ãƒ¼ã‚«ãƒ«ã‚µãƒ¼ãƒãƒ¼ã§å®Ÿè¡Œã—ã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚', 'danger');
        }
    }
    
    /**
     * ä½¿ç”¨å ´é¢ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã®åˆæœŸè¨­å®š
     */
    function setupSceneFilter(data) {
        let scenes;
        if (currentCategoryKey.includes('common_test')) {
             // å…±é€šãƒ†ã‚¹ãƒˆã®å ´åˆã¯ 'year' ã‚’ä½¿ç”¨
            scenes = new Set(data.map(item => item.year).filter(c => c && c.trim() !== ''));
            sceneFilterEl.querySelector('label').textContent = 'å‡ºé¡Œå¹´:';
        } else {
            // æ—…è¡Œç”¨è‹±èªã®å ´åˆã¯ 'category_main' ã‚’ä½¿ç”¨
            scenes = new Set(data.map(item => item.category_main).filter(c => c && c.trim() !== ''));
            sceneFilterEl.querySelector('label').textContent = 'ä½¿ç”¨å ´é¢:';
        }
        
        const sortedScenes = Array.from(scenes).sort((a, b) => a.localeCompare(b, 'ja', { sensitivity: 'base' })); 
        
        sceneFilterEl.innerHTML = '';
        
        // å…¨ã¦ã®å ´é¢ (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ)
        const allOption = document.createElement('option');
        allOption.value = 'ALL';
        allOption.textContent = currentCategoryKey.includes('common_test') ? 'å…¨ã¦ã®å‡ºé¡Œå¹´' : 'å…¨ã¦ã®ä½¿ç”¨å ´é¢';
        sceneFilterEl.appendChild(allOption);
        
        // å„å ´é¢ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ 
        sortedScenes.forEach(scene => {
            const option = document.createElement('option');
            option.value = scene;
            option.textContent = scene;
            sceneFilterEl.appendChild(option);
        });
        
        sceneFilterEl.classList.remove('hidden');
    }
    
    /**
     * ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã«ã‚ˆã‚‹DBã®çµã‚Šè¾¼ã¿
     */
    function filterScenes(scene) {
        if (scene === 'ALL') {
            DB = [...ALL_DB];
        } else {
            if (currentCategoryKey.includes('common_test')) {
                // å…±é€šãƒ†ã‚¹ãƒˆ: yearã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
                DB = ALL_DB.filter(item => item.year === scene);
            } else {
                // æ—…è¡Œç”¨è‹±èª: category_mainã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
                DB = ALL_DB.filter(item => item.category_main === scene);
            }
        }
        
        if (DB.length === 0) {
            englishTextEl.textContent = 'é¸æŠã•ã‚ŒãŸæ¡ä»¶ã«è©²å½“ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚';
            showMessage('ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚', 'danger');
            progressIndicatorEl.textContent = '0/0'; 
            return;
        }

        currentSentenceIndex = 0;
        changeMode(modeSelectorEl.value); 
    }


    /**
     * å˜èªä¸¦ã¹æ›¿ãˆã®ãŸã‚ã«è‹±æ–‡ã‚’æ•´å½¢ã—ã€å˜èªé…åˆ—ã‚’ç”Ÿæˆã™ã‚‹
     */
    function tokenizeSentence(sentence) {
        // å¥èª­ç‚¹ãªã©ã‚’è€ƒæ…®ã—ã€ã‚ˆã‚Šæ­£ç¢ºã«å˜èªã«åˆ†å‰²
        const cleanedSentence = sentence.trim().replace(/[\n\u2018\u2019\u201c\u201d]/g, '').replace(/[.,!?:;â€”â€“"â€'()]/g, ' $& ').replace(/-/g, ' - ').replace(/\s+/g, ' ');
        const words = cleanedSentence.split(/\s+/).filter(w => w.length > 0);
        return words;
    }

    /**
     * ãƒ¢ãƒ¼ãƒ‰ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹
     */
    function changeMode(mode) {
        if (DB.length === 0) return;

        currentMode = parseInt(mode, 10);
        
        // å…¨ã¦ã®ãƒ¢ãƒ¼ãƒ‰è¨­å®šã‚’ãƒªã‚»ãƒƒãƒˆ
        englishTextEl.classList.remove('blur-strong', 'italic', 'text-gray-400');
        translationCardEl.classList.add('hidden');
        toggleTranslationBtn.classList.add('hidden');
        scrambleUiEl.classList.add('hidden');
        checkAnswerBtn.classList.add('hidden');
        resetScrambleBtn.classList.add('hidden');
        messageBoxEl.classList.add('hidden');
        isTranslationVisible = false;

        // ãƒ¢ãƒ¼ãƒ‰å›ºæœ‰ã®UIè¨­å®š
        if (currentMode === 1) { // è‹±æ–‡å…ˆè¡Œ
            toggleTranslationBtn.textContent = 'å’Œè¨³ã‚’è¡¨ç¤º';
            toggleTranslationBtn.classList.remove('hidden');
        } else if (currentMode === 2) { // éŸ³å£°å…ˆè¡Œ
            englishTextEl.classList.add('blur-strong'); // å¼·ã„ã¼ã‹ã—ã‚’é©ç”¨
            toggleTranslationBtn.textContent = 'è‹±æ–‡ãƒ»å’Œè¨³ã‚’è¡¨ç¤º';
            toggleTranslationBtn.classList.remove('hidden');
        } else if (currentMode === 3) { // ä¸¦ã¹æ›¿ãˆ
            scrambleUiEl.classList.remove('hidden');
            checkAnswerBtn.classList.remove('hidden');
            resetScrambleBtn.classList.remove('hidden');
        }

        loadSentence(currentSentenceIndex);
    }

    /**
     * ç¾åœ¨ã®æ–‡ã®ãƒ‡ãƒ¼ã‚¿ã‚’UIã«èª­ã¿è¾¼ã‚€
     */
    function loadSentence(index) {
        if (DB.length === 0) {
             progressIndicatorEl.textContent = '0/0';
             return; 
        }
        
        currentSentenceIndex = (index + DB.length) % DB.length;
        const data = DB[currentSentenceIndex];

        // é€²æ—çŠ¶æ³ã‚’æ›´æ–° (ä¾‹: 21/100)
        progressIndicatorEl.textContent = `${currentSentenceIndex + 1}/${DB.length}`;

        englishTextEl.innerHTML = data.en.replace(/\n/g, '<br>');
        japaneseTextEl.innerHTML = data.ja.replace(/\n/g, '<br>');

        updateTranslationVisibility();

        if (currentMode === 3) {
            setupScrambleMode();
        } else {
             // ãƒ¢ãƒ¼ãƒ‰1/2ã§å’Œè¨³éè¡¨ç¤ºã®å ´åˆã®ã¼ã‹ã—çŠ¶æ…‹ã‚’å†è¨­å®š
            if (currentMode === 2 && !isTranslationVisible) {
                englishTextEl.classList.add('blur-strong');
            } else {
                 englishTextEl.classList.remove('blur-strong');
            }
        }
        
        hideMessage();
    }

    /**
     * å’Œè¨³ã®è¡¨ç¤º/éè¡¨ç¤ºã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ (ãƒ¢ãƒ¼ãƒ‰ 1, 2)
     */
    function toggleTranslation() {
        isTranslationVisible = !isTranslationVisible;
        updateTranslationVisibility();
    }
    
    /**
     * å’Œè¨³ã®è¡¨ç¤ºçŠ¶æ…‹ã‚’æ›´æ–°ã—ã€ãƒˆã‚°ãƒ«ãƒœã‚¿ãƒ³ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’å¤‰æ›´ã™ã‚‹
     */
    function updateTranslationVisibility() {
        if (currentMode === 3) return; 

        if (isTranslationVisible) {
            translationCardEl.classList.remove('hidden');
            if (currentMode === 2) {
                 toggleTranslationBtn.textContent = 'è‹±æ–‡ãƒ»å’Œè¨³ã‚’éè¡¨ç¤º';
            } else {
                toggleTranslationBtn.textContent = 'å’Œè¨³ã‚’éè¡¨ç¤º';
            }
            // è‹±æ–‡ã‚’ã¯ã£ãã‚Šè¡¨ç¤º
            englishTextEl.classList.remove('blur-strong'); 
        } else {
            translationCardEl.classList.add('hidden');
            if (currentMode === 2) {
                 toggleTranslationBtn.textContent = 'è‹±æ–‡ãƒ»å’Œè¨³ã‚’è¡¨ç¤º';
                 englishTextEl.classList.add('blur-strong'); // éŸ³å£°å…ˆè¡Œã§éè¡¨ç¤ºãªã‚‰å¼·ãã¼ã‹ã™
            } else {
                toggleTranslationBtn.textContent = 'å’Œè¨³ã‚’è¡¨ç¤º';
                 englishTextEl.classList.remove('blur-strong');
            }
        }
    }


    /**
     * éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å†ç”Ÿã™ã‚‹
     */
    function playAudio() {
        if (DB.length === 0 || !currentCategoryKey) return;
        
        const data = DB[currentSentenceIndex];
        const config = CATEGORY_MAP[currentCategoryKey];
        
        if (!config || !config.audioFolder) {
             showMessage("ã‚¨ãƒ©ãƒ¼: éŸ³å£°ãƒ•ã‚©ãƒ«ãƒ€è¨­å®šãŒã‚ã‚Šã¾ã›ã‚“ã€‚", 'danger');
             return;
        }

        // éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’å‹•çš„ã«ç”Ÿæˆ: ./audio/{audioFolder}/{data.id}.mp3
        const audioPath = `./audio/${config.audioFolder}/${data.id}.mp3`;
        
        const audio = new Audio(audioPath);
        audio.play().catch(e => {
            console.error("éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã®å†ç”Ÿã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’ç¢ºèªã—ã¦ãã ã•ã„: ", audioPath, e);
            showMessage("éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã¾ãŸã¯å†ç”Ÿã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãƒ‘ã‚¹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚", 'danger');
        });

        if (currentMode === 2 && !isTranslationVisible) {
             showMessage("éŸ³å£°ãŒå†ç”Ÿã•ã‚Œã¾ã—ãŸã€‚è‹±æ–‡ã®æ§‹æˆã‚’è€ƒãˆã¾ã—ã‚‡ã†ã€‚", 'secondary');
        } else if (currentMode === 3) {
             showMessage("éŸ³å£°ãŒå†ç”Ÿã•ã‚Œã¾ã—ãŸã€‚å˜èªã‚’ä¸¦ã¹æ›¿ãˆã¦ãã ã•ã„ã€‚", 'primary');
        }
    }

    /**
     * æ¬¡ã¾ãŸã¯å‰ã®æ–‡ã¸ç§»å‹•ã™ã‚‹
     * @param {number} direction - 1:æ¬¡, -1:å‰
     */
    function navigate(direction) {
        if (DB.length === 0) return;
        let newIndex = currentSentenceIndex + direction;
        // è² ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä¿®æ­£
        if (newIndex < 0) newIndex = DB.length - 1;
        
        isTranslationVisible = false;
        loadSentence(newIndex);
        changeMode(currentMode);
    }
    
    // --- ãƒ¢ãƒ¼ãƒ‰ 3 (ä¸¦ã¹æ›¿ãˆ) ã®ãƒ­ã‚¸ãƒƒã‚¯ ---

    /**
     * ãƒ¢ãƒ¼ãƒ‰3ã®åˆæœŸè¨­å®šã¨å˜èªã‚·ãƒ£ãƒƒãƒ•ãƒ«ã‚’è¡Œã†
     */
    function setupScrambleMode() {
        const data = DB[currentSentenceIndex];
        
        englishTextEl.textContent = 'ä¸¦ã¹æ›¿ãˆãƒ¢ãƒ¼ãƒ‰ï¼šä»¥ä¸‹ã®å˜èªã‚’æ­£ã—ã„é †ç•ªã«çµ„ã¿æ›¿ãˆã¦ãã ã•ã„ã€‚';
        englishTextEl.classList.add('italic', 'text-gray-400');
        englishTextEl.classList.remove('blur-strong'); 

        correctWords = tokenizeSentence(data.en);
        
        scrambledWords = [...correctWords];
        shuffleArray(scrambledWords);
        
        answerSequence = []; 
        
        renderScrambledWords();
        renderAnswerArea();
        hideMessage();
        
        // ä¸¦ã¹æ›¿ãˆãƒ¢ãƒ¼ãƒ‰ã§ã¯å’Œè¨³ã‚’å¼·åˆ¶çš„ã«éè¡¨ç¤ºã«ã™ã‚‹
        translationCardEl.classList.add('hidden');
        
        // ä¸¦ã¹æ›¿ãˆUIã‚’å†è¡¨ç¤º
        scrambleUiEl.classList.remove('hidden');
    }
    
    /**
     * é…åˆ—ã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã™ã‚‹ï¼ˆFisher-Yatesã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ï¼‰
     */
    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
    }

    /**
     * ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã•ã‚ŒãŸå˜èªãƒœã‚¿ãƒ³ã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹
     */
    function renderScrambledWords() {
        scrambledWordsAreaEl.innerHTML = '';
        scrambledWords.forEach((word, index) => {
            // ãƒ†ãƒ¼ãƒ 1: Primaryã‚«ãƒ©ãƒ¼ã‚’ä½¿ç”¨
            const button = document.createElement('button');
            button.className = 'word-button bg-primary text-white text-sm md:text-base font-medium px-3 py-1 rounded-full shadow-md hover:bg-indigo-700 transition-colors duration-200';
            button.textContent = word;
            button.dataset.index = index;
            button.onclick = () => selectWord(word, index);
            if (answerSequence.some(item => item.originalIndex === index)) {
                button.classList.add('selected');
            }
            scrambledWordsAreaEl.appendChild(button);
        });
    }

    /**
     * ãƒ¦ãƒ¼ã‚¶ãƒ¼è§£ç­”ã‚¨ãƒªã‚¢ã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹
     */
    function renderAnswerArea() {
        answerAreaEl.innerHTML = '';
        answerSequence.forEach((item, index) => {
            const span = document.createElement('span');
            span.className = 'answer-word bg-white text-gray-800 text-sm md:text-base px-3 py-1 rounded-full shadow border border-gray-300 cursor-pointer';
            span.textContent = item.word;
            span.dataset.originalIndex = item.originalIndex; 
            span.onclick = () => deselectWord(index);
            answerAreaEl.appendChild(span);
        });
        
        // è‹±æ–‡è¡¨ç¤ºã‚¨ãƒªã‚¢ã«ç¾åœ¨ã®è§£ç­”ã‚’è¡¨ç¤º
        if (answerSequence.length === 0) {
            englishTextEl.textContent = 'ä¸¦ã¹æ›¿ãˆãƒ¢ãƒ¼ãƒ‰ï¼šå˜èªã‚’é¸æŠã—ã¦ãã ã•ã„';
        } else {
            englishTextEl.textContent = answerSequence.map(item => item.word).join(' ');
        }
    }

    /**
     * ã‚·ãƒ£ãƒƒãƒ•ãƒ«å˜èªã‚’é¸æŠã—ã¦è§£ç­”ã‚¨ãƒªã‚¢ã«è¿½åŠ ã™ã‚‹
     */
    function selectWord(word, originalIndex) {
        const button = scrambledWordsAreaEl.querySelector(`[data-index="${originalIndex}"]`);
        if (button) {
            button.classList.add('selected');
        }

        answerSequence.push({ word, originalIndex });
        renderAnswerArea();
        hideMessage();
    }
    
    /**
     * è§£ç­”ã‚¨ãƒªã‚¢ã®å˜èªã‚’å‰Šé™¤ã—ã€ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã‚¨ãƒªã‚¢ã«æˆ»ã™
     */
    function deselectWord(answerIndex) {
        const [removedItem] = answerSequence.splice(answerIndex, 1);
        
        const button = scrambledWordsAreaEl.querySelector(`[data-index="${removedItem.originalIndex}"]`);
        if (button) {
            button.classList.remove('selected');
        }
        
        renderAnswerArea();
        hideMessage();
    }
    
    /**
     * ä¸¦ã¹æ›¿ãˆã‚’ãƒªã‚»ãƒƒãƒˆã™ã‚‹
     */
    function resetScramble() {
        setupScrambleMode(); 
        showMessage("ä¸¦ã¹æ›¿ãˆãŒãƒªã‚»ãƒƒãƒˆã•ã‚Œã¾ã—ãŸã€‚", 'gray');
    }

    /**
     * ä¸¦ã¹æ›¿ãˆãƒ¢ãƒ¼ãƒ‰ã®å›ç­”ãƒã‚§ãƒƒã‚¯ã¨ç”»é¢èª¿æ•´
     */
    function checkScrambledAnswer() {
        if (answerSequence.length === 0) {
            showMessage("å˜èªã‚’é¸æŠã—ã¦è‹±æ–‡ã‚’æ§‹ç¯‰ã—ã¦ãã ã•ã„ã€‚", 'danger');
            return;
        }

        const userSentence = answerSequence.map(item => item.word).join(' ');
        const correctSentence = correctWords.join(' ');
        
        // ç©ºç™½æ–‡å­—ã€å¥èª­ç‚¹ã®çµ±ä¸€çš„ãªæ¯”è¼ƒ
        const normalize = (text) => text.trim().toLowerCase().replace(/\s+/g, ' ').replace(/[.,!?:;]/g, '');
        
        if (normalize(userSentence) === normalize(correctSentence)) {
            showMessage("æ­£è§£ã§ã™ï¼ã‚ˆãã§ãã¾ã—ãŸï¼", 'secondary');
        } else {
            // ä¸æ­£è§£ã®å ´åˆã¯ã€æ­£ã—ã„è‹±æ–‡ã‚’ç¢ºèªã™ã‚‹ã‚ˆã†ã«ä¿ƒã™
            showMessage("æ®‹å¿µï¼ä¸æ­£è§£ã§ã™ã€‚æ­£ã—ã„è‹±æ–‡ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚", 'danger');
        }
        
        // æ­£è§£ãƒ»ä¸æ­£è§£ã«ã‹ã‹ã‚ã‚‰ãšã€å­¦ç¿’ã®ãŸã‚æ­£ã—ã„è‹±æ–‡ã¨å’Œè¨³ã‚’è¡¨ç¤ºã—ã€ä¸¦ã¹æ›¿ãˆUIã‚’éè¡¨ç¤ºã«ã™ã‚‹
        
        // 1. æ­£ã—ã„è‹±æ–‡ã‚’è¡¨ç¤º
        englishTextEl.textContent = correctSentence;
        englishTextEl.classList.remove('italic', 'text-gray-400');
        
        // 2. ä¸¦ã¹æ›¿ãˆUIã‚’éè¡¨ç¤º (å›ç­”ã«ä½¿ã£ãŸã‚¨ãƒªã‚¢ã‚’æ¶ˆã™)
        scrambleUiEl.classList.add('hidden');
        
        // 3. å’Œè¨³ã‚’è¡¨ç¤º
        translationCardEl.classList.remove('hidden');
    }


    /**
     * ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒƒã‚¯ã‚¹ã‚’è¡¨ç¤ºã™ã‚‹
     */
    function showMessage(text, type) {
        messageBoxEl.textContent = text;
        messageBoxEl.className = `text-center py-2 px-4 text-lg font-semibold rounded-lg shadow-sm mt-4`;
        
        let bgColor, textColor;
        switch (type) {
            case 'secondary': bgColor = 'bg-green-200'; textColor = 'text-green-800'; break; // ãƒ†ãƒ¼ãƒ 1ã®Secondary (Emerald)
            case 'danger': bgColor = 'bg-red-200'; textColor = 'text-red-800'; break;
            case 'primary': bgColor = 'bg-indigo-200'; textColor = 'text-indigo-800'; break; // ãƒ†ãƒ¼ãƒ 1ã®Primary (Indigo)
            case 'gray': bgColor = 'bg-gray-200'; textColor = 'text-gray-800'; break;
            default: bgColor = 'bg-yellow-200'; textColor = 'text-yellow-800'; break;
        }
        messageBoxEl.classList.add(bgColor, textColor);
        messageBoxEl.classList.remove('hidden');
    }

    /**
     * ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒƒã‚¯ã‚¹ã‚’éè¡¨ç¤ºã«ã™ã‚‹
     */
    function hideMessage() {
        messageBoxEl.classList.add('hidden');
    }

</script>
</body>
</html>